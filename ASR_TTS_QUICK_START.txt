â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                   ASR/TTS èªéŸ³åŠŸèƒ½å¿«é€Ÿé–‹å§‹æŒ‡å—                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ã€ç³»çµ±å·²å¯¦ç¾ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… ASRService - ä½¿ç”¨ Whisper çš„èªéŸ³è­˜åˆ¥
âœ… TTSService - ä½¿ç”¨ pyttsx3 çš„æ–‡å­—è½‰èªéŸ³
âœ… API ç«¯é» - èªéŸ³å°è©±ã€æ¸¬è©¦ã€æ§åˆ¶æ¥å£
âœ… å®Œæ•´æ¸¬è©¦ - 15 å€‹å–®å…ƒæ¸¬è©¦


ã€ç¬¬ä¸€æ­¥ï¼šå®‰è£ä¾è³´ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
pip install openai-whisper pyttsx3 soundfile librosa

â³ é¦–æ¬¡å®‰è£æœƒä¸‹è¼‰ Whisper æ¨¡å‹ (~140MB)ï¼Œéœ€è¦ 1-5 åˆ†é˜


ã€ç¬¬äºŒæ­¥ï¼šé©—è­‰å®‰è£ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
python -c "import whisper; print('Whisper OK')"
python -c "import pyttsx3; print('pyttsx3 OK')"


ã€ç¬¬ä¸‰æ­¥ï¼šé‹è¡Œæ‡‰ç”¨ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# æ–¹å¼ Aï¼šç›´æ¥é‹è¡Œï¼ˆé–‹ç™¼æ¨¡å¼ï¼‰
python -m src.main

# æ–¹å¼ Bï¼šå•Ÿå‹• FastAPI æœå‹™
uvicorn src.api.app:app --reload --port 8000

# æˆ–ç”¨ Gunicornï¼ˆç”Ÿç”¢æ¨¡å¼ï¼‰
gunicorn -w 1 -b 0.0.0.0:8000 src.api.app:app


ã€ç¬¬å››æ­¥ï¼šæ¸¬è©¦åŠŸèƒ½ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

A) æ–‡æœ¬å°è©±
â”€â”€â”€â”€â”€â”€â”€â”€
curl -X POST http://localhost:8000/dialogue/text \
  -H "X-API-Key: yuan-secret-key" \
  -H "Content-Type: application/json" \
  -d '{"session_id": "user123", "text": "æˆ‘è¦é£¯ç³°"}'


B) æª¢æŸ¥ ASR ç‹€æ…‹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
curl -H "X-API-Key: yuan-secret-key" \
  http://localhost:8000/asr/test

é æœŸå›æ‡‰:
{
  "service": "ASR (Whisper)",
  "status": "ready",
  "model": "base",
  "language": "zh"
}


C) æª¢æŸ¥ TTS ç‹€æ…‹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
curl -H "X-API-Key: yuan-secret-key" \
  http://localhost:8000/tts/test

é æœŸå›æ‡‰:
{
  "service": "TTS (pyttsx3)",
  "status": "ready",
  "properties": {...}
}


D) TTS æ’­æ”¾æ¸¬è©¦
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
curl -X POST http://localhost:8000/tts/speak \
  -H "X-API-Key: yuan-secret-key" \
  -d "text=æ­¡è¿å…‰è‡¨" \
  -G


E) èªéŸ³å°è©±ï¼ˆéœ€è¦éŸ³è¨Šæ–‡ä»¶ï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
curl -X POST http://localhost:8000/dialogue/voice \
  -H "X-API-Key: yuan-secret-key" \
  -F "session_id=user123" \
  -F "audio_file=@speech.wav"


ã€ç¬¬äº”æ­¥ï¼šé‹è¡Œæ¸¬è©¦ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# é‹è¡Œæ‰€æœ‰ ASR/TTS æ¸¬è©¦
pytest tests/test_asr_tts_integration.py -v

# é‹è¡Œå®Œæ•´æ¸¬è©¦å¥—ä»¶ï¼ˆæ‡‰è©²æœ‰ 140+ å€‹æ¸¬è©¦ï¼‰
pytest tests/ -v


ã€ä»£ç¢¼ä½¿ç”¨ç¤ºä¾‹ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. ASR è­˜åˆ¥éŸ³è¨Šæ–‡ä»¶
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
from src.services.asr_service import ASRService

asr = ASRService(model_size="base", language="zh")
result = asr.transcribe("audio.wav")
print(f"è­˜åˆ¥çµæœ: {result['text']}")
print(f"èªè¨€: {result['language']}")
print(f"ä¿¡å¿ƒåº¦: {result['confidence']}")


2. TTS æ’­æ”¾æ–‡å­—
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
from src.services.tts_service import TTSService

tts = TTSService(language="zh", rate=150)
tts.speak("æ­¡è¿å…‰è‡¨ï¼Œè«‹å•è¦é»ä»€éº¼ï¼Ÿ")


3. å®Œæ•´çš„èªéŸ³å°è©±æµç¨‹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
from src.services.asr_service import ASRService
from src.services.tts_service import TTSService
from src.dm.dialogue_manager import DialogueManager
from src.dm.session_store import InMemorySessionStore

# åˆå§‹åŒ–
asr = ASRService()
tts = TTSService()
dm = DialogueManager(store=InMemorySessionStore())

# æµç¨‹
user_audio = "user_speech.wav"
asr_result = asr.transcribe(user_audio)
user_text = asr_result["text"]

dm_response = dm.handle("session123", user_text)
tts.speak(dm_response)


ã€é…ç½®é¸é …ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ç·¨è¼¯ .env æ–‡ä»¶ï¼š

# ASR é…ç½®
ASR_PROVIDER=whisper          # èªéŸ³è­˜åˆ¥æä¾›å•†
ASR_MODEL_SIZE=base           # æ¨¡å‹å¤§å° (tiny/base/small/medium/large)
ASR_LANGUAGE=zh               # è­˜åˆ¥èªè¨€ (zh, en, ja, etc.)

# TTS é…ç½®
TTS_PROVIDER=pyttsx3          # æ–‡å­—è½‰èªéŸ³æä¾›å•†
TTS_LANGUAGE=zh               # èªè¨€
TTS_RATE=150                  # èªé€Ÿ (50-300ï¼Œè¶Šé«˜è¶Šå¿«)
TTS_VOLUME=1.0                # éŸ³é‡ (0.0-1.0)

# API é…ç½®
API_KEY=yuan-secret-key       # API å¯†é‘°
API_PORT=8000                 # æœå‹™ç«¯å£


ã€å¸¸è¦‹å•é¡Œã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Q: Whisper ä¸‹è¼‰å¤±æ•—ï¼Ÿ
A: æ‰‹å‹•ä¸‹è¼‰: python -c "import whisper; whisper.load_model('base')"

Q: TTS æ²’æœ‰è²éŸ³ï¼Ÿ
A: æª¢æŸ¥ç³»çµ±éŸ³é‡æˆ–å˜—è©¦ä¿å­˜åˆ°æ–‡ä»¶: tts.speak("test", save_to_file="test.wav")

Q: æ¨¡å‹å¤ªå¤§ï¼Œå…§å­˜ä¸è¶³ï¼Ÿ
A: ä½¿ç”¨æ›´å°çš„æ¨¡å‹: ASRService(model_size="tiny")
   æˆ–åªä½¿ç”¨ TTS: tts = TTSService()

Q: éœ€è¦æ›´é«˜è³ªé‡çš„ TTSï¼Ÿ
A: å°‡ä¾†å¯å‡ç´šè‡³ Google Cloud TTSã€Azureã€æˆ– Elevenlabs


ã€API ç«¯é»ç¸½çµã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

POST  /dialogue/text          æ–‡æœ¬å°è©±ï¼ˆæ–‡å­—â†’æ–‡å­—ï¼‰
POST  /dialogue/voice         èªéŸ³å°è©±ï¼ˆéŸ³è¨Šâ†’æ–‡å­—â†’æ–‡å­—â†’éŸ³è¨Šï¼‰
GET   /asr/test              ASR ç‹€æ…‹æª¢æŸ¥
GET   /tts/test              TTS ç‹€æ…‹æª¢æŸ¥
POST  /tts/speak             ç›´æ¥ TTS æ’­æ”¾

æ‰€æœ‰ç«¯é»éƒ½éœ€è¦ Header: X-API-Key: yuan-secret-key


ã€æ–‡ä»¶æ¸…å–®ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

æ ¸å¿ƒå¯¦ç¾ï¼š
  src/services/asr_service.py        ASR èªéŸ³è­˜åˆ¥
  src/services/tts_service.py        TTS æ–‡å­—è½‰èªéŸ³
  src/api/app.py                     FastAPI ç«¯é»ï¼ˆå·²æ›´æ–°ï¼‰

æ–‡æª”ï¼š
  ASR_TTS_GUIDE.md                   å®Œæ•´ä½¿ç”¨æŒ‡å—
  ASR_TTS_QUICK_START.txt            æœ¬æ–‡ä»¶

æ¸¬è©¦ï¼š
  tests/test_asr_tts_integration.py  15 å€‹å–®å…ƒæ¸¬è©¦

é…ç½®ï¼š
  .env                               ç’°å¢ƒé…ç½®ï¼ˆå·²æ›´æ–°ï¼‰


ã€æ€§èƒ½æŒ‡æ¨™ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ASR (Whisper base):
  âœ“ æº–ç¢ºåº¦ï¼šä¸­~é«˜ï¼ˆ95%+ï¼‰
  âœ“ é€Ÿåº¦ï¼š10-30 ç§’ï¼ˆ30 ç§’éŸ³è¨Šï¼‰
  âœ“ å…§å­˜ï¼š~1GB

TTS (pyttsx3):
  âœ“ å»¶é²ï¼š< 100ms
  âœ“ CPUï¼šä¸­ç­‰
  âœ“ å…§å­˜ï¼š< 50MB
  âœ“ è³ªé‡ï¼šä¸­ç­‰ï¼ˆæ©Ÿæ¢°æ„Ÿï¼‰


ã€ä¸‹ä¸€æ­¥ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. âœ… å®Œæˆä¾è³´å®‰è£
2. âœ… é©—è­‰ ASR/TTS æ­£å¸¸å·¥ä½œ
3. âœ… é‹è¡Œ API æœå‹™
4. âœ… æ¸¬è©¦å„å€‹ç«¯é»
5. âœ… é›†æˆåˆ°å®¢æˆ¶ç«¯ï¼ˆWeb/ç§»å‹•/èªéŸ³ç›’ï¼‰

å‡ç´šé¸é …ï¼š
  - æ›´é«˜è³ªé‡ TTSï¼ˆGoogle/Azureï¼‰
  - å¯¦æ™‚èªéŸ³æµï¼ˆWebRTCï¼‰
  - å¤šèªè¨€æ”¯æŒ
  - æ€§èƒ½å„ªåŒ–


ã€è¯ç¹«æ–¹å¼ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

æ–‡æª”ï¼šASR_TTS_GUIDE.md
å¿«é€Ÿåƒè€ƒï¼šæœ¬æ–‡ä»¶
ä»£ç¢¼ä½ç½®ï¼šsrc/services/

é‡åˆ°å•é¡Œï¼Ÿ
  1. æª¢æŸ¥ .env é…ç½®
  2. æŸ¥çœ‹æœå‹™æ—¥èªŒ
  3. åƒè€ƒ ASR_TTS_GUIDE.md æ•…éšœæ’é™¤ç« ç¯€


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    ç³»çµ±å·²æº–å‚™å¥½é€²è¡ŒèªéŸ³å°è©±ï¼ ğŸ™ï¸                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
